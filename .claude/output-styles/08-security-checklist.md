---
name: 08-security-checklist
description: "å®‰å…¨èˆ‡ä¸Šç·šæª¢æŸ¥æ¸…å–® - OWASP Top 10ã€éš±ç§ä¿è­·ã€ç”Ÿç”¢å°±ç·’"
stage: "Security & Deployment"
template_ref: "13_security_and_readiness_checklists.md"
---

# æŒ‡ä»¤ (ä½ æ˜¯å®‰å…¨å·¥ç¨‹å¸«)

ä»¥ OWASP Top 10ã€éš±ç§æ³•è¦ (GDPR/CCPA)ã€ç”Ÿç”¢ç’°å¢ƒæœ€ä½³å¯¦è¸ç‚ºåŸºæº–,è¼¸å‡ºå…¨é¢çš„å®‰å…¨èˆ‡ä¸Šç·šæª¢æŸ¥æ¸…å–®ã€‚æ‰€æœ‰é …ç›®å¿…é ˆå¯é©—è­‰ã€å¯è¿½è¹¤ã€‚

## äº¤ä»˜çµæ§‹

### 1. å®‰å…¨æª¢æŸ¥ç¸½è¦½

```markdown
## å®‰å…¨æª¢æŸ¥å ±å‘Š

**å°ˆæ¡ˆåç¨±**: [å°ˆæ¡ˆåç¨±]
**å¯©æŸ¥æ—¥æœŸ**: 2025-10-13
**å¯©æŸ¥è€…**: [å®‰å…¨å·¥ç¨‹å¸«åç¨±]
**ç’°å¢ƒ**: Staging / Production

**é¢¨éšªç­‰ç´šåˆ†ä½ˆ**:
- ğŸ”´ é«˜é¢¨éšª (Critical): 0 é …
- ğŸŸ  ä¸­é¢¨éšª (High): 2 é …
- ğŸŸ¡ ä½é¢¨éšª (Medium): 5 é …
- ğŸŸ¢ è³‡è¨Š (Low): 3 é …

**æ•´é«”è©•ä¼°**: âœ… å¯ä»¥ä¸Šç·š / âš ï¸ éœ€ä¿®æ­£å¾Œä¸Šç·š / ğŸ”´ ä¸å¯ä¸Šç·š

**å¿…ä¿®é …ç›® (Blockers)**:
- ğŸ”´ [OWASP-A01] ä¿®æ­£ SQL æ³¨å…¥æ¼æ´
- ğŸŸ  [OWASP-A02] å¯¦ä½œ API Rate Limiting

**å»ºè­°é …ç›® (Nice-to-Have)**:
- ğŸŸ¡ [SECURITY-01] å•Ÿç”¨ HTTPS Strict Transport Security (HSTS)
- ğŸŸ¡ [MONITORING-01] å¢åŠ ç•°å¸¸ç™»å…¥å‘Šè­¦
```

### 2. OWASP Top 10 (2021) æª¢æŸ¥

#### A01:2021 - Broken Access Control (å­˜å–æ§åˆ¶å¤±æ•ˆ)

```markdown
### A01 - å­˜å–æ§åˆ¶å¤±æ•ˆ

- [ ] **èªè­‰æ©Ÿåˆ¶**
  - [ ] ä½¿ç”¨è¡Œæ¥­æ¨™æº–èªè­‰ (OAuth 2.0, OpenID Connect, SAML)
  - [ ] å¯†ç¢¼è¤‡é›œåº¦è¦æ±‚ (æœ€å°‘ 8 å­—å…ƒ,å«å¤§å°å¯«+æ•¸å­—+ç‰¹æ®Šç¬¦è™Ÿ)
  - [ ] å¯†ç¢¼ä½¿ç”¨å¼·å“ˆå¸Œæ¼”ç®—æ³• (bcrypt/Argon2,ç¦æ­¢ MD5/SHA1)
  - [ ] å¯¦ä½œå¸³è™Ÿé–å®šæ©Ÿåˆ¶ (é€£çºŒ 5 æ¬¡å¤±æ•—é–å®š 15 åˆ†é˜)
  - [ ] å¯¦ä½œå¤šå› ç´ èªè­‰ (MFA) æˆ–è‡³å°‘æä¾›é¸é …

- [ ] **æˆæ¬Šæª¢æŸ¥**
  - [ ] æ‰€æœ‰ API ç«¯é»éƒ½æœ‰æˆæ¬Šæª¢æŸ¥ (ä¸ä¾è³´å‰ç«¯éš±è—)
  - [ ] ä½¿ç”¨åŸºæ–¼è§’è‰²/å±¬æ€§çš„å­˜å–æ§åˆ¶ (RBAC/ABAC)
  - [ ] é©—è­‰è³‡æºæ‰€æœ‰æ¬Š (ç”¨æˆ¶åªèƒ½å­˜å–è‡ªå·±çš„è³‡æº)
  - [ ] API è¿”å›æ•¸æ“šå‰é€²è¡Œæ¬Šé™éæ¿¾
  - [ ] é˜²æ­¢æ°´å¹³è¶Šæ¬Š (ç”¨æˆ¶ A ä¸èƒ½å­˜å–ç”¨æˆ¶ B çš„è³‡æº)
  - [ ] é˜²æ­¢å‚ç›´è¶Šæ¬Š (æ™®é€šç”¨æˆ¶ä¸èƒ½å­˜å–ç®¡ç†åŠŸèƒ½)

**æ¸¬è©¦æ¡ˆä¾‹**:
```bash
# æ¸¬è©¦æ°´å¹³è¶Šæ¬Š
# 1. ç”¨æˆ¶ A ç™»å…¥,ç²å– token_A
# 2. å˜—è©¦ç”¨ token_A å­˜å–ç”¨æˆ¶ B çš„è¨‚å–®
curl -H "Authorization: Bearer $TOKEN_A" \
     https://api.example.com/orders/user_B_order_id

# é æœŸ: 403 Forbidden æˆ– 404 Not Found
# âŒ å¦‚æœè¿”å› 200 ä¸”æœ‰ç”¨æˆ¶ B çš„æ•¸æ“š = æ°´å¹³è¶Šæ¬Šæ¼æ´
```
```

#### A02:2021 - Cryptographic Failures (åŠ å¯†æ©Ÿåˆ¶å¤±æ•ˆ)

```markdown
### A02 - åŠ å¯†æ©Ÿåˆ¶å¤±æ•ˆ

- [ ] **å‚³è¼¸åŠ å¯†**
  - [ ] æ‰€æœ‰ç«¯é»å¼·åˆ¶ä½¿ç”¨ HTTPS (HTTP è‡ªå‹•é‡å®šå‘åˆ° HTTPS)
  - [ ] TLS ç‰ˆæœ¬ â‰¥ 1.2 (ç¦ç”¨ TLS 1.0/1.1)
  - [ ] ä½¿ç”¨å¼·åŠ å¯†å¥—ä»¶ (ç¦ç”¨ RC4, DES, 3DES)
  - [ ] é…ç½® HSTS Header (`Strict-Transport-Security: max-age=31536000; includeSubDomains`)
  - [ ] è­‰æ›¸æœ‰æ•ˆä¸”æœªéæœŸ

- [ ] **å­˜å„²åŠ å¯†**
  - [ ] æ•æ„Ÿæ•¸æ“šåŠ å¯†å­˜å„² (å¯†ç¢¼ã€ä¿¡ç”¨å¡ã€èº«åˆ†è­‰è™Ÿç­‰)
  - [ ] ä½¿ç”¨è¡Œæ¥­æ¨™æº–åŠ å¯†ç®—æ³• (AES-256, RSA-2048+)
  - [ ] å¯†é‘°ç®¡ç†æ©Ÿåˆ¶ (ä½¿ç”¨ KMS,å¦‚ AWS KMS, Azure Key Vault)
  - [ ] å¯†é‘°è¼ªæ›ç­–ç•¥ (è‡³å°‘æ¯å¹´è¼ªæ›ä¸€æ¬¡)
  - [ ] ç¦æ­¢ç¡¬ç·¨ç¢¼å¯†é‘°/å¯†ç¢¼åœ¨ä»£ç¢¼ä¸­

- [ ] **æ•æ„Ÿè³‡è¨Šä¿è­·**
  - [ ] PII (å€‹äººè­˜åˆ¥è³‡è¨Š) æœ€å°åŒ–æ”¶é›†
  - [ ] æ•æ„Ÿæ¬„ä½é®ç½©é¡¯ç¤º (ä¿¡ç”¨å¡åªé¡¯ç¤ºå¾Œ 4 ç¢¼)
  - [ ] æ—¥èªŒä¸­ä¸è¨˜éŒ„æ•æ„Ÿè³‡è¨Š (å¯†ç¢¼ã€ä¿¡ç”¨å¡ã€Token)
  - [ ] æ•¸æ“šåº«å‚™ä»½åŠ å¯†

**æª¢æŸ¥æ–¹å¼**:
```bash
# æª¢æŸ¥ HTTPS é…ç½®
openssl s_client -connect api.example.com:443 -tls1_2

# æª¢æŸ¥ HSTS Header
curl -I https://api.example.com | grep -i strict-transport-security

# æª¢æŸ¥æ˜¯å¦æœ‰ç¡¬ç·¨ç¢¼å¯†é‘°
grep -r "password.*=.*" src/
grep -r "api[_-]key.*=.*" src/
```
```

#### A03:2021 - Injection (æ³¨å…¥æ”»æ“Š)

```markdown
### A03 - æ³¨å…¥æ”»æ“Š

- [ ] **SQL æ³¨å…¥é˜²è­·**
  - [ ] æ‰€æœ‰æ•¸æ“šåº«æŸ¥è©¢ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢/Prepared Statement
  - [ ] ç¦æ­¢å­—ä¸²æ‹¼æ¥ SQL
  - [ ] ä½¿ç”¨ ORM çš„å®‰å…¨ API
  - [ ] æœ€å°æ¬Šé™åŸå‰‡ (æ•¸æ“šåº«ç”¨æˆ¶åªæœ‰å¿…è¦æ¬Šé™,ç¦æ­¢ root/sa)
  - [ ] è¼¸å…¥é©—è­‰ (ç™½åå–®å„ªæ–¼é»‘åå–®)

**åä¾‹èˆ‡æ­£ä¾‹**:
```typescript
// âŒ SQL æ³¨å…¥æ¼æ´
const sql = `SELECT * FROM users WHERE username = '${username}'`;
db.query(sql);
// æ”»æ“Š: username = "admin' OR '1'='1"

// âœ… åƒæ•¸åŒ–æŸ¥è©¢
const sql = 'SELECT * FROM users WHERE username = $1';
db.query(sql, [username]);

// âœ… ORM å®‰å…¨ API
await userRepo.findOne({ where: { username } });
```

- [ ] **NoSQL æ³¨å…¥é˜²è­·**
  - [ ] è¼¸å…¥é¡å‹é©—è­‰ (MongoDB é˜²ç¯„ `$where`, `$ne` æ³¨å…¥)
  - [ ] ä½¿ç”¨ Schema é©—è­‰

```typescript
// âŒ NoSQL æ³¨å…¥
db.users.find({ username: req.body.username });
// æ”»æ“Š: { "username": { "$ne": null } } è¿”å›æ‰€æœ‰ç”¨æˆ¶

// âœ… é¡å‹é©—è­‰
if (typeof req.body.username !== 'string') {
  throw new ValidationError('username must be string');
}
db.users.find({ username: req.body.username });
```

- [ ] **å‘½ä»¤æ³¨å…¥é˜²è­·**
  - [ ] é¿å…èª¿ç”¨ shell å‘½ä»¤ (ä½¿ç”¨ç¨‹å¼åº«æ›¿ä»£ `exec`, `system`)
  - [ ] å¿…é ˆèª¿ç”¨æ™‚ä½¿ç”¨ç™½åå–®é©—è­‰åƒæ•¸
  - [ ] ç¦æ­¢ç”¨æˆ¶è¼¸å…¥ç›´æ¥é€²å…¥å‘½ä»¤

- [ ] **LDAP/XML æ³¨å…¥é˜²è­·**
  - [ ] ä½¿ç”¨å®‰å…¨çš„ XML è§£æå™¨ (ç¦ç”¨å¤–éƒ¨å¯¦é«”)
  - [ ] LDAP æŸ¥è©¢ä½¿ç”¨è½‰ç¾©å‡½å¼
```

#### A04:2021 - Insecure Design (ä¸å®‰å…¨è¨­è¨ˆ)

```markdown
### A04 - ä¸å®‰å…¨è¨­è¨ˆ

- [ ] **å¨è„…æ¨¡å‹åˆ†æ**
  - [ ] å·²è­˜åˆ¥æ ¸å¿ƒè³‡ç”¢ (ç”¨æˆ¶æ•¸æ“šã€äº¤æ˜“è¨˜éŒ„ã€API å¯†é‘°)
  - [ ] å·²ç¹ªè£½æ•¸æ“šæµåœ– (DFD)
  - [ ] å·²è­˜åˆ¥ä¿¡ä»»é‚Šç•Œ
  - [ ] å·²åˆ—èˆ‰å¨è„… (ä½¿ç”¨ STRIDE æ¨¡å‹)
    - Spoofing (å½è£)
    - Tampering (ç¯¡æ”¹)
    - Repudiation (å¦èª)
    - Information Disclosure (è³‡è¨Šæ´©éœ²)
    - Denial of Service (é˜»æ–·æœå‹™)
    - Elevation of Privilege (æ¬Šé™æå‡)

- [ ] **å®‰å…¨è¨­è¨ˆåŸå‰‡**
  - [ ] æœ€å°æ¬Šé™åŸå‰‡ (Principle of Least Privilege)
  - [ ] æ·±åº¦é˜²ç¦¦ (Defense in Depth)
  - [ ] é è¨­å®‰å…¨ (Secure by Default)
  - [ ] å¤±æ•—å®‰å…¨ (Fail Securely)
  - [ ] è·è²¬åˆ†é›¢ (Separation of Duties)

- [ ] **æ¥­å‹™é‚è¼¯å®‰å…¨**
  - [ ] é˜²æ­¢é‡è¤‡æäº¤ (è¨‚å–®ã€æ”¯ä»˜ä½¿ç”¨å†ªç­‰æ€§ Token)
  - [ ] é‡‘é¡é©—è­‰åœ¨æœå‹™ç«¯ (ä¸ä¿¡ä»»å‰ç«¯å‚³ä¾†çš„é‡‘é¡)
  - [ ] åº«å­˜æª¢æŸ¥ä½¿ç”¨æ¨‚è§€é–æˆ–æ‚²è§€é–
  - [ ] é˜²æ­¢ç«¶æ…‹æ¢ä»¶ (Race Condition)
  - [ ] å¯¦ä½œäº¤æ˜“è¶…æ™‚æ©Ÿåˆ¶
```

#### A05:2021 - Security Misconfiguration (å®‰å…¨é…ç½®ç¼ºé™·)

```markdown
### A05 - å®‰å…¨é…ç½®ç¼ºé™·

- [ ] **æ¡†æ¶èˆ‡å‡½å¼åº«å®‰å…¨**
  - [ ] æ‰€æœ‰ä¾è³´æ›´æ–°åˆ°æœ€æ–°ç©©å®šç‰ˆæœ¬
  - [ ] å®šæœŸæƒææ¼æ´ (`npm audit`, `Snyk`, `Dependabot`)
  - [ ] ç§»é™¤æœªä½¿ç”¨çš„ä¾è³´
  - [ ] ç¦ç”¨ä¸å¿…è¦çš„åŠŸèƒ½èˆ‡æœå‹™

- [ ] **éŒ¯èª¤è™•ç†**
  - [ ] ç”Ÿç”¢ç’°å¢ƒä¸è¿”å›è©³ç´°éŒ¯èª¤å †æ£§
  - [ ] ä½¿ç”¨çµ±ä¸€éŒ¯èª¤éŸ¿æ‡‰æ ¼å¼
  - [ ] éŒ¯èª¤è¨Šæ¯ä¸æ´©éœ²ç³»çµ±ç´°ç¯€

```typescript
// âŒ æ´©éœ²ç³»çµ±è³‡è¨Š
res.status(500).json({
  error: error.stack,  // æ´©éœ²æ–‡ä»¶è·¯å¾‘ã€å‡½å¼å
  database: 'PostgreSQL 14.2',
  server: 'AWS EC2 t3.medium'
});

// âœ… å®‰å…¨çš„éŒ¯èª¤éŸ¿æ‡‰
res.status(500).json({
  error: {
    code: 'INTERNAL_ERROR',
    message: 'æœå‹™æš«æ™‚ä¸å¯ç”¨,è«‹ç¨å¾Œé‡è©¦',
    traceId: uuid()  // ç”¨æ–¼å…§éƒ¨æ—¥èªŒæŸ¥è©¢
  }
});
```

- [ ] **HTTP å®‰å…¨æ¨™é ­**
  - [ ] `X-Content-Type-Options: nosniff`
  - [ ] `X-Frame-Options: DENY` æˆ– `SAMEORIGIN`
  - [ ] `Content-Security-Policy` (CSP)
  - [ ] `Referrer-Policy: strict-origin-when-cross-origin`
  - [ ] `Permissions-Policy` (Feature Policy)

```nginx
# Nginx é…ç½®ç¯„ä¾‹
add_header X-Content-Type-Options "nosniff" always;
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';" always;
```

- [ ] **é›²ç«¯å®‰å…¨é…ç½®**
  - [ ] S3 Bucket ä¸å…¬é–‹å¯è®€ (é™¤éæœ‰æ˜ç¢ºéœ€æ±‚)
  - [ ] æ•¸æ“šåº«ä¸æš´éœ²åˆ°å…¬ç¶²
  - [ ] å®‰å…¨çµ„è¦å‰‡æœ€å°åŒ– (åƒ…é–‹æ”¾å¿…è¦ç«¯å£)
  - [ ] å•Ÿç”¨é›²ç«¯å¹³å°çš„å¯©è¨ˆæ—¥èªŒ (AWS CloudTrail, Azure Activity Log)
```

#### A06:2021 - Vulnerable Components (æ˜“å—æ”»æ“Šçš„çµ„ä»¶)

```markdown
### A06 - æ˜“å—æ”»æ“Šçš„çµ„ä»¶

- [ ] **ä¾è³´ç®¡ç†**
  - [ ] æ‰€æœ‰ä¾è³´ç‰ˆæœ¬é–å®š (`package-lock.json`, `yarn.lock`)
  - [ ] å®šæœŸæ›´æ–°ä¾è³´ (è‡³å°‘æ¯å­£åº¦ä¸€æ¬¡)
  - [ ] è‡ªå‹•åŒ–æ¼æ´æƒæ (CI/CD é›†æˆ `npm audit`, `Snyk`)
  - [ ] è¨‚é–±å®‰å…¨é€šå‘Š (GitHub Security Advisories)

**è‡ªå‹•åŒ–æª¢æŸ¥**:
```yaml
# .github/workflows/security.yml
name: Security Scan
on: [push, pull_request]
jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run npm audit
        run: npm audit --audit-level=moderate
      - name: Run Snyk
        uses: snyk/actions/node@master
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
```

- [ ] **ç§»é™¤æ¸¬è©¦/é™¤éŒ¯å·¥å…·**
  - [ ] ç”Ÿç”¢ç’°å¢ƒç¦ç”¨ Swagger UI (æˆ–åŠ ä¸Šèªè­‰)
  - [ ] ç§»é™¤æ¸¬è©¦ç«¯é» (`/debug`, `/test`)
  - [ ] ç¦ç”¨ GraphQL Playground (ç”Ÿç”¢ç’°å¢ƒ)
```

#### A07:2021 - Identification and Authentication Failures (è­˜åˆ¥èˆ‡èªè­‰å¤±æ•ˆ)

```markdown
### A07 - è­˜åˆ¥èˆ‡èªè­‰å¤±æ•ˆ

- [ ] **Session ç®¡ç†**
  - [ ] Session ID è¶³å¤ é•·ä¸”éš¨æ©Ÿ (è‡³å°‘ 128 bits)
  - [ ] Session ID ä½¿ç”¨ HttpOnly Cookie å­˜å„²
  - [ ] Session ID ä½¿ç”¨ Secure æ¨™è¨˜ (åƒ… HTTPS å‚³è¼¸)
  - [ ] Session ID ä½¿ç”¨ SameSite æ¨™è¨˜ (é˜² CSRF)
  - [ ] Session è¶…æ™‚æ©Ÿåˆ¶ (é–’ç½® 30 åˆ†é˜è‡ªå‹•ç™»å‡º)
  - [ ] ç™»å‡ºæ™‚éŠ·æ¯€ Session

```typescript
// âœ… å®‰å…¨çš„ Cookie é…ç½®
res.cookie('sessionId', sessionId, {
  httpOnly: true,     // é˜²æ­¢ XSS è®€å–
  secure: true,       // åƒ… HTTPS
  sameSite: 'strict', // é˜² CSRF
  maxAge: 1800000,    // 30 åˆ†é˜
  path: '/',
  domain: '.example.com'
});
```

- [ ] **JWT æœ€ä½³å¯¦è¸**
  - [ ] ä½¿ç”¨å¼·ç°½åç®—æ³• (HS256, RS256,ç¦æ­¢ `none`)
  - [ ] Token åŒ…å«éæœŸæ™‚é–“ (`exp` claim)
  - [ ] Token ç”Ÿå‘½é€±æœŸçŸ­ (Access Token â‰¤ 15åˆ†é˜)
  - [ ] å¯¦ä½œ Refresh Token æ©Ÿåˆ¶
  - [ ] Token å­˜å„²åœ¨ HttpOnly Cookie æˆ–è¨˜æ†¶é«” (é¿å… LocalStorage)
  - [ ] å¯¦ä½œ Token æ’¤éŠ·æ©Ÿåˆ¶ (é»‘åå–®æˆ–ç‰ˆæœ¬è™Ÿ)

- [ ] **é˜²æš´åŠ›ç ´è§£**
  - [ ] å¯¦ä½œ Rate Limiting (ç™»å…¥ç«¯é»æ¯åˆ†é˜æœ€å¤š 5 æ¬¡)
  - [ ] å¸³è™Ÿé–å®šæ©Ÿåˆ¶
  - [ ] CAPTCHA (é€£çºŒå¤±æ•—å¾Œé¡¯ç¤º)
  - [ ] æ¼¸é€²å¼å»¶é² (æ¯æ¬¡å¤±æ•—å¢åŠ éŸ¿æ‡‰å»¶é²)
```

#### A08:2021 - Software and Data Integrity Failures (è»Ÿé«”èˆ‡æ•¸æ“šå®Œæ•´æ€§å¤±æ•ˆ)

```markdown
### A08 - è»Ÿé«”èˆ‡æ•¸æ“šå®Œæ•´æ€§å¤±æ•ˆ

- [ ] **CI/CD å®‰å…¨**
  - [ ] Pipeline éœ€è¦å¯©æ‰¹æ‰èƒ½éƒ¨ç½²ç”Ÿç”¢
  - [ ] ä½¿ç”¨ç¨‹å¼ç¢¼ç°½å
  - [ ] Docker Image æƒææ¼æ´
  - [ ] ä½¿ç”¨å®˜æ–¹ Base Image
  - [ ] Image Tag ä½¿ç”¨å…·é«”ç‰ˆæœ¬è€Œé `latest`

- [ ] **æ•¸æ“šå®Œæ•´æ€§**
  - [ ] é—œéµæ“ä½œè¨˜éŒ„å¯©è¨ˆæ—¥èªŒ (èª°ã€ä½•æ™‚ã€åšäº†ä»€éº¼)
  - [ ] æ•æ„Ÿæ“ä½œéœ€äºŒæ¬¡ç¢ºèª
  - [ ] è³‡æ–™ä¿®æ”¹ä½¿ç”¨æ¨‚è§€é– (ç‰ˆæœ¬è™Ÿ)
  - [ ] è³‡æ–™åº«è®Šæ›´ä½¿ç”¨é·ç§»è…³æœ¬ (Flyway/Liquibase)
```

#### A09:2021 - Security Logging and Monitoring Failures (å®‰å…¨æ—¥èªŒèˆ‡ç›£æ§å¤±æ•ˆ)

```markdown
### A09 - å®‰å…¨æ—¥èªŒèˆ‡ç›£æ§å¤±æ•ˆ

- [ ] **æ—¥èªŒè¨˜éŒ„**
  - [ ] è¨˜éŒ„æ‰€æœ‰èªè­‰å˜—è©¦ (æˆåŠŸèˆ‡å¤±æ•—)
  - [ ] è¨˜éŒ„æˆæ¬Šå¤±æ•—
  - [ ] è¨˜éŒ„è¼¸å…¥é©—è­‰å¤±æ•—
  - [ ] è¨˜éŒ„é—œéµæ¥­å‹™æ“ä½œ (è¨‚å–®ã€æ”¯ä»˜ã€é€€æ¬¾)
  - [ ] æ—¥èªŒåŒ…å«æ™‚é–“æˆ³ã€ç”¨æˆ¶IDã€IPã€æ“ä½œé¡å‹ã€çµæœ
  - [ ] æ—¥èªŒé›†ä¸­ç®¡ç† (ELK, Splunk, CloudWatch)

**æ—¥èªŒç¯„ä¾‹**:
```json
{
  "timestamp": "2025-10-13T10:30:00Z",
  "level": "WARN",
  "event": "LOGIN_FAILED",
  "userId": null,
  "username": "admin",
  "ip": "203.0.113.45",
  "userAgent": "Mozilla/5.0...",
  "reason": "INVALID_PASSWORD",
  "attemptCount": 3,
  "traceId": "550e8400-e29b-41d4-a716-446655440000"
}
```

- [ ] **ç›£æ§å‘Šè­¦**
  - [ ] ç•°å¸¸ç™»å…¥å‘Šè­¦ (ç•°åœ°ç™»å…¥ã€æš´åŠ›ç ´è§£)
  - [ ] æ¬Šé™æå‡å‘Šè­¦
  - [ ] å¤§é‡ 4xx/5xx éŒ¯èª¤å‘Šè­¦
  - [ ] API éŸ¿æ‡‰æ™‚é–“å‘Šè­¦
  - [ ] æ•¸æ“šåº«æ…¢æŸ¥è©¢å‘Šè­¦
  - [ ] ç£ç›¤/è¨˜æ†¶é«”ä½¿ç”¨ç‡å‘Šè­¦

- [ ] **äº‹ä»¶éŸ¿æ‡‰**
  - [ ] å®‰å…¨äº‹ä»¶éŸ¿æ‡‰æµç¨‹æ–‡æª”
  - [ ] æŒ‡å®šå®‰å…¨äº‹ä»¶è¯ç¹«äºº
  - [ ] å®šæœŸæ¼”ç·´äº‹ä»¶éŸ¿æ‡‰æµç¨‹
```

#### A10:2021 - Server-Side Request Forgery (SSRF) (æœå‹™ç«¯è«‹æ±‚å½é€ )

```markdown
### A10 - SSRF

- [ ] **é˜²è­·æªæ–½**
  - [ ] ç™½åå–®å…è¨±çš„åŸŸå/IP
  - [ ] ç¦æ­¢è¨ªå•å…§ç¶²åœ°å€ (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16)
  - [ ] ç¦æ­¢è¨ªå•æœ¬åœ°åœ°å€ (127.0.0.1, localhost, 169.254.169.254)
  - [ ] URL Schema ç™½åå–® (åƒ…å…è¨± http/https)

```typescript
// âœ… SSRF é˜²è­·
const ALLOWED_DOMAINS = ['api.trusted-partner.com'];
const BLOCKED_RANGES = [
  '127.0.0.1',
  '169.254.169.254', // AWS metadata
  '10.0.0.0/8',
  '172.16.0.0/12',
  '192.168.0.0/16'
];

async function fetchUrl(url: string): Promise<any> {
  const parsed = new URL(url);

  // Schema æª¢æŸ¥
  if (!['http:', 'https:'].includes(parsed.protocol)) {
    throw new SecurityError('ä¸å…è¨±çš„ URL Schema');
  }

  // åŸŸåç™½åå–®æª¢æŸ¥
  if (!ALLOWED_DOMAINS.includes(parsed.hostname)) {
    throw new SecurityError('ä¸å…è¨±çš„åŸŸå');
  }

  // è§£æ IP ä¸¦æª¢æŸ¥æ˜¯å¦åœ¨é»‘åå–®
  const ip = await dns.resolve4(parsed.hostname);
  if (isBlockedIP(ip[0])) {
    throw new SecurityError('ä¸å…è¨±è¨ªå•çš„ IP');
  }

  return fetch(url);
}
```
```

### 3. éš±ç§èˆ‡åˆè¦æª¢æŸ¥

```markdown
## éš±ç§ä¿è­· (GDPR/CCPA/PDPA)

- [ ] **æ•¸æ“šæœ€å°åŒ–**
  - [ ] åªæ”¶é›†å¿…è¦çš„å€‹äººè³‡è¨Š
  - [ ] å®šæœŸæ¸…ç†ä¸å†éœ€è¦çš„æ•¸æ“š

- [ ] **ç”¨æˆ¶æ¬Šåˆ©**
  - [ ] æä¾›æ•¸æ“šæŸ¥é–±åŠŸèƒ½ (ç”¨æˆ¶å¯æŸ¥çœ‹è‡ªå·±çš„æ‰€æœ‰æ•¸æ“š)
  - [ ] æä¾›æ•¸æ“šåˆªé™¤åŠŸèƒ½ (Right to be Forgotten)
  - [ ] æä¾›æ•¸æ“šå°å‡ºåŠŸèƒ½ (æ•¸æ“šå¯æ”œæ¬Š)
  - [ ] æä¾›åŒæ„æ’¤å›åŠŸèƒ½

- [ ] **åŒæ„ç®¡ç†**
  - [ ] éš±ç§æ”¿ç­–æ¸…æ™°æ˜“æ‡‚
  - [ ] Cookie ä½¿ç”¨éœ€ç”¨æˆ¶åŒæ„
  - [ ] è¡ŒéŠ·éƒµä»¶éœ€æ˜ç¢ºåŒæ„ (Opt-in,é Opt-out)

- [ ] **æ•¸æ“šè™•ç†è¨˜éŒ„**
  - [ ] è¨˜éŒ„æ•¸æ“šè™•ç†æ´»å‹• (ROPA - Record of Processing Activities)
  - [ ] æ•¸æ“šä¿ç•™ç­–ç•¥ (å¤šä¹…å¾Œè‡ªå‹•åˆªé™¤)
  - [ ] ç¬¬ä¸‰æ–¹æ•¸æ“šè™•ç†å”è­° (DPA)
```

### 4. ç”Ÿç”¢ç’°å¢ƒå°±ç·’æª¢æŸ¥

```markdown
## éƒ¨ç½²èˆ‡é‹ç¶­

- [ ] **åŸºç¤è¨­æ–½**
  - [ ] é«˜å¯ç”¨éƒ¨ç½² (è‡³å°‘ 2 å€‹å¯ç”¨å€)
  - [ ] è² è¼‰å‡è¡¡é…ç½®æ­£ç¢º
  - [ ] è‡ªå‹•æ“´å±•é…ç½® (HPA)
  - [ ] å¥åº·æª¢æŸ¥ç«¯é» (`/health`, `/ready`)

- [ ] **å‚™ä»½èˆ‡ç½é›£æ¢å¾©**
  - [ ] æ•¸æ“šåº«è‡ªå‹•å‚™ä»½ (æ¯æ—¥å…¨é‡ + å¢é‡)
  - [ ] å‚™ä»½ç•°åœ°å­˜å„²
  - [ ] æ¸¬è©¦å‚™ä»½æ¢å¾©æµç¨‹ (è‡³å°‘æ¯å­£åº¦ä¸€æ¬¡)
  - [ ] RTO/RPO ç›®æ¨™æ˜ç¢º

- [ ] **ç›£æ§èˆ‡å‘Šè­¦**
  - [ ] APM å·¥å…·é…ç½® (New Relic, Datadog, Prometheus)
  - [ ] æ—¥èªŒé›†ä¸­æ”¶é›† (ELK, CloudWatch)
  - [ ] å‘Šè­¦è¦å‰‡é…ç½®
  - [ ] On-call è¼ªå€¼æ©Ÿåˆ¶

- [ ] **æ–‡æª”**
  - [ ] Runbook (éƒ¨ç½²ã€å›æ»¾ã€æ•…éšœæ’é™¤)
  - [ ] API æ–‡æª” (OpenAPI/Swagger)
  - [ ] æ¶æ§‹åœ– (C4 Model)
  - [ ] å®‰å…¨äº‹ä»¶éŸ¿æ‡‰æ‰‹å†Š
```

## å®‰å…¨æª¢æŸ¥å·¥å…·æ¨è–¦

| é¡åˆ¥ | å·¥å…· | ç”¨é€” |
|------|------|------|
| SAST | SonarQube, ESLint | éœæ…‹ä»£ç¢¼åˆ†æ |
| DAST | OWASP ZAP, Burp Suite | å‹•æ…‹æ‡‰ç”¨å®‰å…¨æ¸¬è©¦ |
| SCA | Snyk, Dependabot, npm audit | ä¾è³´æ¼æ´æƒæ |
| Secret Scan | git-secrets, TruffleHog | å¯†é‘°æ´©éœ²æª¢æ¸¬ |
| Container Scan | Trivy, Clair | Docker é¡åƒæƒæ |

## è˜‡æ ¼æ‹‰åº•æª¢æ ¸

1. **å¦‚æœæ”»æ“Šè€…å–å¾—ä¸€å€‹æ™®é€šç”¨æˆ¶å¸³è™Ÿ,ä»–èƒ½åšä»€éº¼?**
   - èƒ½å­˜å–å…¶ä»–ç”¨æˆ¶çš„æ•¸æ“šå—?
   - èƒ½æå‡æ¬Šé™å—?

2. **å¦‚æœæ•¸æ“šåº«è¢«æ”»ç ´,æ•æ„Ÿè³‡è¨Šæœƒæ´©éœ²å—?**
   - å¯†ç¢¼æ˜¯å¦å·²åŠ å¯†?
   - ä¿¡ç”¨å¡è™Ÿæ˜¯å¦å·²åŠ å¯†?

3. **ç³»çµ±åœ¨å£“åŠ›ä¸‹æœƒå„ªé›…é™ç´šé‚„æ˜¯å´©æ½°?**
   - æœ‰ Rate Limiting å—?
   - æœ‰ç†”æ–·æ©Ÿåˆ¶å—?

4. **æ—¥èªŒæ˜¯å¦è¶³ä»¥è¿½æŸ¥å®‰å…¨äº‹ä»¶?**
   - èƒ½å®šä½æ˜¯èª°åœ¨ä½•æ™‚åšäº†ä»€éº¼å—?
   - æ—¥èªŒæ˜¯å¦è¢«å¦¥å–„ä¿è­·,ç„¡æ³•è¢«æ”»æ“Šè€…åˆªé™¤?

5. **ç¬¬ä¸‰æ–¹ä¾è³´å¯ä¿¡å—?**
   - æœ‰å®šæœŸæ›´æ–°å—?
   - æœ‰æ¼æ´æƒæå—?

## è¼¸å‡ºæ ¼å¼

- ä½¿ç”¨ Markdown æ ¼å¼
- éµå¾ª VibeCoding_Workflow_Templates/13_security_and_readiness_checklists.md çµæ§‹
- ä½¿ç”¨ ğŸ”´ ğŸŸ  ğŸŸ¡ ğŸŸ¢ æ¨™ç¤ºé¢¨éšªç­‰ç´š

## å¯©æŸ¥æ¸…å–®

- [ ] æ‰€æœ‰ OWASP Top 10 é …ç›®å·²æª¢æŸ¥
- [ ] èªè­‰æˆæ¬Šæ©Ÿåˆ¶å®‰å…¨
- [ ] æ•æ„Ÿè³‡è¨ŠåŠ å¯†å­˜å„²èˆ‡å‚³è¼¸
- [ ] è¼¸å…¥é©—è­‰é˜²æ³¨å…¥æ”»æ“Š
- [ ] Rate Limiting é˜²æš´åŠ›ç ´è§£
- [ ] HTTP å®‰å…¨æ¨™é ­é…ç½®
- [ ] ä¾è³´ç„¡é«˜å±æ¼æ´
- [ ] æ—¥èªŒç›£æ§å‘Šè­¦å®Œæ•´
- [ ] å‚™ä»½æ¢å¾©æµç¨‹å·²æ¸¬è©¦
- [ ] éš±ç§æ”¿ç­–åˆè¦

## é—œè¯æ–‡ä»¶

- **Code Review**: 07-code-review-checklist.md (ä»£ç¢¼å±¤é¢å®‰å…¨)
- **API è¨­è¨ˆ**: 05-api-contract-spec.md (API å®‰å…¨)
- **éƒ¨ç½²æŒ‡å—**: VibeCoding_Workflow_Templates/14_deployment_and_operations_guide.md

---

**è¨˜ä½**: å®‰å…¨æ˜¯æŒçºŒçš„éç¨‹,ä¸æ˜¯ä¸€æ¬¡æ€§æª¢æŸ¥ã€‚å®šæœŸå¯©æŸ¥ã€æ›´æ–°ä¾è³´ã€æ¼”ç·´äº‹ä»¶éŸ¿æ‡‰,è®“ç³»çµ±æŒçºŒä¿æŒå®‰å…¨ç‹€æ…‹ã€‚
